---
title: "Taylor Swift Song Analysis"
output: html_document
---

```{r, loading packages, results = "hide", message = FALSE}
library(rvest) # For web mining
library(stringr) # For cleaning Strings
library(dplyr) # For manipulating data frames
#library(ggplot2) # For producing visualizations
#library(ggrepel) # For making the labels distinct
library(tm) # for wordcloud
library(SnowballC) # text stemming
library(wordcloud) # generates wordcloud images
library(RColorBrewer) # Color Paletts 
library(RCurl) # possible dependency in wordcloud function
#detach("package:ggrepel", unload=TRUE)
#detach("package:ggplot2", unload=TRUE)
library(ggplot2)

```

```{r}
# Will be used to rescale the rankings of the songs within each album
rescale10 <- function(vec, xmin, xmax) {
  range <- xmax - xmin
  above_zero <- vec - xmin
  scores <- ((10 * above_zero)/range)
  return(scores)
}
```


```{r ts1 names}
# Picture to Burn is not here
# Tied together with a smile is not here
# A perfectly good heart is not here
# Invisible is not here
# All have been manually Added Below
ts1_names <- c("Tim McGraw",
               "Teardrops on My Guitar",
               "A Place in This World",
               "Cold as You",
               "The Outside",
               "Stay Beautiful",
               "Should've Said No",
               "Mary's Song",
               "Our Song",
               "I'm Only Me When I'm With You")
ts1_names <- str_replace_all(ts1_names, pattern = " ", replacement = "_")

```

```{r}
picture_to_burn_lyrics <- "State the obvious, I didn't get my perfect fantasy I realize you love yourself more than you could ever love me So go and tell your friends that I'm obsessive and crazy That's fine I'll tell mine you're gay And by the way I hate that stupid old pickup truck You never let me drive You're a redneck heartbreak Who's really bad at lying So watch me strike a match On all my wasted time As far as I'm concerned you'reJust another picture to burn There's no time for tears, I'm just sitting here planning my revenge There's nothing stopping me From going out with all of your best friends And if you come around saying sorry to me My daddy's gonna show you how sorry you'll be I hate that stupid old pickup truck You never let me drive You're a redneck heartbreak Who's really bad at lying So watch me strike a match On all my wasted time As far as I'm concerned you're Just another picture to burn If you're missing me, You'd better keep it to yourself Cause coming back around here Would be bad for your health I hate that stupid old pickup truck You never let me drive You're a redneck heartbreak Who's really bad at lying So watch me strike a match On all my wasted time In case you haven't heard, I really really hate that Burn, burn, burn, baby, burn You're just another picture to burn Baby, burn"
```


```{r}
tied_together_with_a_smile_lyrics <- "Seems the only one who doesn't see your beauty Is the face in the mirror looking back at you You walk around here thinking you're not pretty But that's not true, 'cause I know you Hold on Baby you're losing it The water's high You're jumping into it And letting go And no one knows That you cry But you don't tell anyone That you might Not be the golden one And you're tied together with a smile But you're coming undone I guess it's true that love was all you wanted 'Cause you're giving it away like it's extra change Hoping it will end up in his pocket But he leaves you out like a penny in the rain Oh, 'cause it's not his price to pay Not his price to pay Hold on Baby you're losing it The water's high You're jumping into it And letting go And no one knows That you cry But you don't tell anyone That you might Not be the golden one And you're tied together with a smile But you're coming undone Hold on Baby you're losing it The water's high You're jumping into it And letting go And no one knows That you cry But you don't tell anyone That you might Not be the golden one And you're tied together with a smile But you're coming undone"
```

```{r}
a_perfectly_good_heart_lyrics <- "Why would you wanna break a perfectly good heart? Why would you wanna take our love and tear it all apart, now? Why would you wanna make the very first scar? Why would you wanna break a perfectly good heart? Maybe I should've seen the signs, should've read the writing on the wall And realized by the distance in your eyes that I would be the one to fall No matter what you say, I still can't believe That you would walk away It don't make sense to me, but Why would you wanna break a perfectly good heart? Why would you wanna take our love and tear it all apart, now? Why would you wanna make the very first scar? Why would you wanna break a perfectly good heart? It's not unbroken anymore How do I get it back the way it was before? Why would you wanna break a perfectly good heart? Why would you wanna take our love and tear it all apart, now? Why would you wanna make the very first scar? Why would you wanna break a perfectly good heart? Why would you wanna break a perfectly good heart? Why would you wanna take our love and tear it all apart, now? Why would you wanna make the very first scar? Why would you wanna break a perfectly good heart?"
```

```{r}
invisible_lyrics <- "She can't see the way your eyes Light up when you smile She'll never notice how you stop and stare Whenever she walks by And you can't see me wanting you the way you want her But you are everything to me I just want to show you She don't even know you She's never going to love you like I want to And you just see right through me If you only knew me We could be a beautiful Miracle Unbelievable Instead of just invisible There's a fire inside of you That can't help but shine through She's never going to see the light No matter what you do And all I think about is how to make you think of me And everything that we could be I just want to show you She don't even know you She's never going to love you like I want to And you just see right through me If you only knew me We could be a beautiful Miracle Unbelievable Instead of just invisible Like shadows in a faded light Oh, we're invisible I just want to open your eyes And make you realize I just want to show you She don't even know you Baby, let me love you Let me want you You just see right through me But if you only knew me We could be a beautiful Miracle Unbelievable Instead of just invisible She can't see the way your eyes Light up when you smile"
```

```{r}
picture_to_burn_lyrics <- str_replace_all(picture_to_burn_lyrics, pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " ")
picture_to_burn_lyrics[[1]] <- (tolower(picture_to_burn_lyrics[[1]]))

tied_together_with_a_smile_lyrics <- str_replace_all(tied_together_with_a_smile_lyrics, pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " ")
tied_together_with_a_smile_lyrics[[1]] <- (tolower(tied_together_with_a_smile_lyrics[[1]]))

a_perfectly_good_heart_lyrics <- str_replace_all(a_perfectly_good_heart_lyrics, pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " ")
a_perfectly_good_heart_lyrics[[1]] <- (tolower(a_perfectly_good_heart_lyrics[[1]]))

invisible_lyrics <- str_replace_all(invisible_lyrics, pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " ")
invisible_lyrics[[1]] <- (tolower(invisible_lyrics[[1]]))

```


```{r, read ts1}
# Initialize an empty vector to be filled with lyrics
ts1_song_lyrics <- (rep(NA, length(ts1_names)))

# Read the data from the web source using pipe notation for brevity
for (i in 1:length(ts1_names)) {
  ts1_song_lyrics[i] <- (paste0("../data/ts1/", ts1_names[i]) %>% 
                          read_html() %>%
                          html_nodes("#lyrics") %>%
                          html_text() %>%
           # Next we'll replace new lines and dashes with spaces
                          str_replace_all(pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " "))
}

# Do some additional preprocessing

for (i in 1:length(ts1_song_lyrics)) {
  # First change everything to lowercase
  ts1_song_lyrics[[i]] <- tolower(ts1_song_lyrics[[i]])
  
  # Next remove any double quotations inside words
  ts1_song_lyrics[[i]] <- str_replace_all(ts1_song_lyrics[[i]], "\"", "")
  
  # Finally use gsub to remove the \ characters
  ts1_song_lyrics[[i]] <- (gsub("\\", "", ts1_song_lyrics[[i]], fixed = TRUE))
}

for (i in 1:length(ts1_song_lyrics)) {
  ts1_song_lyrics[[i]] <- ts1_song_lyrics[[i]][ts1_song_lyrics[[i]] != "la" & 
                                     ts1_song_lyrics[[i]] != "mmm" &
                                     ts1_song_lyrics[[i]] != ""]
}

```

```{r}
ts1_song_lyrics[14] <- "placeholder"
ts1_song_lyrics[14] <- a_perfectly_good_heart_lyrics
ts1_song_lyrics[13] <- invisible_lyrics
ts1_song_lyrics[12] <- ts1_song_lyrics[10]
ts1_song_lyrics[11] <- ts1_song_lyrics[9]
ts1_song_lyrics[10] <- ts1_song_lyrics[8]
ts1_song_lyrics[9] <- ts1_song_lyrics[7]
ts1_song_lyrics[8] <- ts1_song_lyrics[6]
ts1_song_lyrics[7] <- tied_together_with_a_smile_lyrics
ts1_song_lyrics[6] <- ts1_song_lyrics[5]
ts1_song_lyrics[5] <- ts1_song_lyrics[4]
ts1_song_lyrics[4] <- ts1_song_lyrics[3]
ts1_song_lyrics[3] <- ts1_song_lyrics[2]
ts1_song_lyrics[2] <- picture_to_burn_lyrics

```


```{r, test ts1 lyrics}
for (i in 1:length(ts1_song_lyrics)) {
  print(ts1_song_lyrics[[i]][1:5])
}
```

```{r, update ts1_names}
ts1_names <- c("Tim McGraw",
               "Picture to Burn",
               "Teardrops on My Guitar",
               "A Place in This World",
               "Cold as You",
               "The Outside",
               "Tied Together with a Smile",
               "Stay Beautiful",
               "Should've Said No",
               "Mary's Song",
               "Our Song",
               "I'm Only Me When I'm With You",
               "Invisible",
               "A Perfectly Good Heart")
ts1_names <- str_replace_all(ts1_names, pattern = " ", replacement = "_")

# For this and all other rankings, lower is better.
ts1_ranking <- c(3, 14, 6, 5, 4, 9, 2, 7, 1, 11, 10, 13, 8, 12)
ts1_ranking <- rescale10(ts1_ranking, 1, 14)
```


```{r ts2 names}
# Nothing Missing
ts2_names <- c("Fearless",
               "Fifteen",
               "Love Story",
               "Hey Stephen",
               "White Horse",
               "You Belong With Me",
               "Breathe",
               "Tell Me Why",
               "You're Not Sorry",
               "The Way I Loved You",
               "Forever And Always",
               "The Best Day",
               "Change")

ts2_names <- str_replace_all(ts2_names, pattern = " ", replacement = "_")

ts2_ranking <- rescale10(c(3, 12, 7, 4, 8, 11, 2, 10, 6, 9, 5, 13, 1), 1, 13)
```


```{r, read ts2}
# Initialize an empty vector to be filled with lyrics
ts2_song_lyrics <- (rep(NA, length(ts2_names)))

# Read the data from the web source using pipe notation for brevity
for (i in 1:length(ts2_names)) {
  ts2_song_lyrics[i] <- (paste0("../data/ts2/", ts2_names[i]) %>% 
                          read_html() %>%
                          html_nodes("#lyrics") %>%
                          html_text() %>%
           # Next we'll replace new lines and dashes with spaces
                          str_replace_all(pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " "))
}

# Do some additional preprocessing

for (i in 1:length(ts2_song_lyrics)) {
  # First change everything to lowercase
  ts2_song_lyrics[[i]] <- tolower(ts2_song_lyrics[[i]])
  
  # Next remove any double quotations inside words
  ts2_song_lyrics[[i]] <- str_replace_all(ts2_song_lyrics[[i]], "\"", "")
  
  # Finally use gsub to remove the \ characters
  ts2_song_lyrics[[i]] <- (gsub("\\", "", ts2_song_lyrics[[i]], fixed = TRUE))
}

for (i in 1:length(ts2_song_lyrics)) {
  ts2_song_lyrics[[i]] <- ts2_song_lyrics[[i]][ts2_song_lyrics[[i]] != "la" & 
                                     ts2_song_lyrics[[i]] != "mmm" &
                                     ts2_song_lyrics[[i]] != ""]
}
2
```

```{r, test ts2 lyrics}
for (i in 1:length(ts2_song_lyrics)) {
  print(ts2_song_lyrics[[i]][1:5])
}
```

```{r, import fearless platinum}
# Nothing Missing
fp_names <- c("Jump then Fall",
              "Untouchable",
              "Come in With the Rain",
              "SuperStar",
              "The Other Side of the Door")

fp_names <- str_replace_all(fp_names, pattern = " ", replacement = "_")

fp_song_lyrics <- (rep(NA, length(fp_names)))

# Read the data from the web source using pipe notation for brevity
for (i in 1:length(fp_names)) {
  fp_song_lyrics[i] <- (paste0("../data/ts2/", fp_names[i]) %>% 
                          read_html() %>%
                          html_nodes("#lyrics") %>%
                          html_text() %>%
           # Next we'll replace new lines and dashes with spaces
                          str_replace_all(pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " "))
}

# Do some additional preprocessing

for (i in 1:length(fp_song_lyrics)) {
  # First change everything to lowercase
  fp_song_lyrics[[i]] <- tolower(fp_song_lyrics[[i]])
  
  # Next remove any double quotations inside words
  fp_song_lyrics[[i]] <- str_replace_all(fp_song_lyrics[[i]], "\"", "")
  
  # Finally use gsub to remove the \ characters
  fp_song_lyrics[[i]] <- (gsub("\\", "", fp_song_lyrics[[i]], fixed = TRUE))
}

for (i in 1:length(fp_song_lyrics)) {
  fp_song_lyrics[[i]] <- fp_song_lyrics[[i]][fp_song_lyrics[[i]] != "la" & 
                                     fp_song_lyrics[[i]] != "mmm" &
                                     fp_song_lyrics[[i]] != ""]
}

fp_ranking <- rescale10(c(4, 1, 2, 5, 3), 1, 5)
```


```{r ts3 names}
# Nothing Missing
ts3_names <- c("Mine",
               "Sparks Fly",
               "Back To December",
               "Speak Now",
               "Dear John",
               "Mean",
               "The Story Of Us",
               "Never Grow Up",
               "Enchanted",
               "Better Than Revenge",
               "Innocent",
               "Haunted",
               "Last Kiss",
               "Long Live")

ts3_names <- str_replace_all(ts3_names, pattern = " ", replacement = "_")

ts3_ranking <- rescale10(c(14, 1, 13, 2, 10, 6, 4, 8, 3, 11, 12, 5, 9, 7), 1, 14)
```



```{r, read ts3}
# Initialize an empty vector to be filled with lyrics
ts3_song_lyrics <- (rep(NA, length(ts3_names)))

# Read the data from the web source using pipe notation for brevity
for (i in 1:length(ts3_names)) {
  ts3_song_lyrics[i] <- (paste0("../data/ts3/", ts3_names[i]) %>% 
                          read_html() %>%
                          html_nodes("#lyrics") %>%
                          html_text() %>%
           # Next we'll replace new lines and dashes with spaces
                          str_replace_all(pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " "))
}

# Do some additional preprocessing

for (i in 1:length(ts3_song_lyrics)) {
  # First change everything to lowercase
  ts3_song_lyrics[[i]] <- tolower(ts3_song_lyrics[[i]])
  
  # Next remove any double quotations inside words
  ts3_song_lyrics[[i]] <- str_replace_all(ts3_song_lyrics[[i]], "\"", "")
  
  # Finally use gsub to remove the \ characters
  ts3_song_lyrics[[i]] <- (gsub("\\", "", ts3_song_lyrics[[i]], fixed = TRUE))
}

for (i in 1:length(ts3_song_lyrics)) {
  ts3_song_lyrics[[i]] <- ts3_song_lyrics[[i]][ts3_song_lyrics[[i]] != "la" & 
                                     ts3_song_lyrics[[i]] != "mmm" &
                                     ts3_song_lyrics[[i]] != ""]
}
3

```

```{r, test ts3 lyrics}
for (i in 1:length(ts3_song_lyrics)) {
  print(ts3_song_lyrics[[i]][1:5])
}
```

```{r ts4 names}
# Everything Has Changed is Missing
# Added below
ts4_names <- c("State of Grace",
               "Red",
               "Treacherous",
               "I Knew You Were Trouble",
               "All Too Well",
               "22",
               "I Almost Do",
               "We Are Never Ever Getting Back Together",
               "Stay Stay Stay",
               "The Last Time",
               "Holy Ground",
               "Sad Beautiful Tragic",
               "The Lucky One",
               "Starlight",
               "Begin Again")

ts4_names <- str_replace_all(ts4_names, pattern = " ", replacement = "_")
```

```{r}
everything_has_changed_lyrics <- "All I knew this morning when I woke Is I know something now, know something now I didn't before And all I've seen since 18 hours ago is green eyes and freckles and your smile In the back of my mind making me feel like I just want to know you better Know you better, know you better now I just want to know you better Know you better, know you better now I just want to know you better Know you better, know you better now I just want to know you, know you, know you 'Cause all I know is we said hello And your eyes look like coming home All I know is a simple name, everything has changed All I know is you held the door You'll be mine and I'll be yours All I know since yesterday is everything has changed And all my walls stood tall painted blue And I'll take them down Take them down and open up the door for you And all I feel in my stomach is butterflies The beautiful kind, making up for lost time Taking flight, making me feel like I just want to know you better Know you better, know you better now I just want to know you better Know you better, know you better now I just want to know you better Know you better, know you better now I just want to know you, know you, know you 'Cause all I know is we said hello And your eyes look like coming home All I know is a simple name, everything has changed All I know is you held the door You'll be mine and I'll be yours All I know since yesterday is everything has changed Come back and tell me why I'm feeling like i've missed you all this time And meet me there tonight And let me know that it's not all in my mind I just want to know you better Know you better, know you better now I just want to know you, know you, know you 'Cause all I know is we said hello And your eyes look like coming home All I know is a simple name, everything has changed All I know is you held the door You'll be mine and I'll be yours All I know since yesterday is everything has changed All I know is we said hello So dust off your highest hopes All I know is pouring rain And everything has changed All I know is a new found grace All my days, I'll know your face All I know since yesterday is everything has changed"
```

```{r}
everything_has_changed_lyrics <- str_replace_all(everything_has_changed_lyrics, pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " ")
everything_has_changed_lyrics[[1]] <- (tolower(everything_has_changed_lyrics[[1]]))

```

```{r, read ts4}
# Initialize an empty vector to be filled with lyrics
ts4_song_lyrics <- (rep(NA, length(ts4_names)))

# Read the data from the web source using pipe notation for brevity
for (i in 1:length(ts4_names)) {
  ts4_song_lyrics[i] <- (paste0("../data/ts4/", ts4_names[i]) %>% 
                          read_html() %>%
                          html_nodes("#lyrics") %>%
                          html_text() %>%
           # Next we'll replace new lines and dashes with spaces
                          str_replace_all(pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " "))
}

# Do some additional preprocessing

for (i in 1:length(ts4_song_lyrics)) {
  # First change everything to lowercase
  ts4_song_lyrics[[i]] <- tolower(ts4_song_lyrics[[i]])
  
  # Next remove any double quotations inside words
  ts4_song_lyrics[[i]] <- str_replace_all(ts4_song_lyrics[[i]], "\"", "")
  
  # Finally use gsub to remove the \ characters
  ts4_song_lyrics[[i]] <- (gsub("\\", "", ts4_song_lyrics[[i]], fixed = TRUE))
}

for (i in 1:length(ts4_song_lyrics)) {
  ts4_song_lyrics[[i]] <- ts4_song_lyrics[[i]][ts4_song_lyrics[[i]] != "la" & 
                                     ts4_song_lyrics[[i]] != "mmm" &
                                     ts4_song_lyrics[[i]] != ""]
}
```

```{r}
length(ts4_song_lyrics)
ts4_song_lyrics[16] <- ts4_song_lyrics[15]
ts4_song_lyrics[15] <- ts4_song_lyrics[14]
ts4_song_lyrics[14] <- everything_has_changed_lyrics
```


```{r, test ts4 lyrics}
for (i in 1:length(ts4_song_lyrics)) {
  print(ts4_song_lyrics[[i]][1:5])
}
```

```{r, update ts4_names}
ts4_names <- c("State of Grace",
               "Red",
               "Treacherous",
               "I Knew You Were Trouble",
               "All Too Well",
               "22",
               "I Almost Do",
               "We Are Never Ever Getting Back Together",
               "Stay Stay Stay",
               "The Last Time",
               "Holy Ground",
               "Sad Beautiful Tragic",
               "The Lucky One",
               "Everything Has Changed",
               "Starlight",
               "Begin Again")

ts4_names <- str_replace_all(ts4_names, pattern = " ", replacement = "_")

ts4_ranking <- rescale10(c(11, 4, 7, 15, 1, 3, 6, 14, 13, 16, 5, 8, 2, 12, 9, 10), 1, 16)
```

```{r}
# Welcome to New York is Missing
# All you had to do was stay is missing
# Wildest Dreams is missing
# All have been manually added
ts5_names <- c("Blank Space",
               "Style",
               "Out of the Woods",
               "Shake It Off",
               "I Wish You Would",
               "Bad Blood",
               "How You Get the Girl",
               "This Love",
               "I Know Places",
               "Clean",
               "Wonderland",
               "You Are in Love",
               "New Romantics")

ts5_names <- str_replace_all(ts5_names, pattern = " ", replacement = "_")
```

```{r}
welcome_to_ny_lyrics <- "Walking through a crowd, the village is aglow Kaleidoscope of loud heartbeats under coats Everybody here wanted something more Searching for a sound we hadn't heard before And it said Welcome to New York! It's been waiting for you Welcome to New York Welcome to New York Welcome to New York! It's been waiting for you Welcome to New York Welcome to New York It's a new soundtrack I could dance to this beat (beat) Forevermore The lights are so bright But they never blind me (me) Welcome to New York! It's been waiting for you Welcome to New York Welcome to New York When we first dropped our bags on apartment floors Took our broken hearts, put them in a drawer Everybody here was someone else before And you can want who you want Boys and boys and girls and girls Welcome to New York! It's been waiting for you Welcome to New York Welcome to New York Welcome to New York! It's been waiting for you Welcome to New York Welcome to New York It's a new soundtrack I could dance to this beat (beat) Forevermore The lights are so bright But they never blind me (me) Welcome to New York! It's been waiting for you Welcome to New York Welcome to New York Like any great love, it keeps you guessing Like any real love, it's ever-changing Like any true love, it drives you crazy But you know you wouldn't change anything, anything, anything Welcome to New York! It's been waiting for you Welcome to New York Welcome to New York Welcome to New York! It's been waiting for you Welcome to New York Welcome to New York It's a new soundtrack I could dance to this beat (beat) Forevermore The lights are so bright But they never blind me (me) Welcome to New York! It's been waiting for you Welcome to New York Welcome to New York"

```

```{r}
welcome_to_ny_lyrics <- str_replace_all(welcome_to_ny_lyrics, pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " ")
welcome_to_ny_lyrics[[1]] <- (tolower(welcome_to_ny_lyrics[[1]]))
```

```{r}
all_you_had_to_do_was_stay_lyrics <- "People like you always want back The love they gave away And people like me wanna believe you When you say you've changed The more I think about it now The less I know All I know is that you drove us Off the road (Stay!) Hey All you had to do was stay Had me in the palm of your hand Then why'd you have to go and lock me out when I let you in? (Stay!) Hey Now you say you want it back Now that it's just too late Well could've been easy All you had to do was (stay!) All you had to do was (stay!) All you had to do was (stay!) All you had to do was (stay!) All you had to do was stay Here you are now calling me up But I don't know what to say I've been picking up the pieces Of the mess you made People like you always want back The love they pushed aside But people like me are gone forever When you say goodbye (Stay!) Hey All you had to do was stay Had me in the palm of your hand Then why'd you have to go and lock me out when I let you in? (Stay!) Hey Now you say you want it back Now that it's just too late Well could've been easy All you had to do was (stay!) All you had to do was (stay!) All you had to do was (stay!) All you had to do was (stay!) All you had to do was stay stay stay stay stay Let me remind you This was what you wanted (Oh! Oh! Oh-oh-oh!) You ended it You were all I wanted (Oh! Oh! Oh-oh-oh!) But not like this Not like this... not like this... Oh! All you had to do was! (Stay!) Hey All you had to do was stay Had me in the palm of your hand Then why'd you want to go and lock me out when I let you in? (Stay!) Hey Now you say you want it back Now that it's just too late Well could've been easy All you had to do was (Stay!) Hey All you had to do was stay Had me in the palm of your hand Then why'd you have to go and lock me out when I let you in? (Stay!) Hey Now you say you want it back Now that it's just too late (all you had to do was stay) Well could've been easy All you had to do was (stay!) All you had to do was (stay!) All you had to do was (stay!) All you had to do was (stay!) All you had to do was (stay!)"
```

```{r}
all_you_had_to_do_was_stay_lyrics <- str_replace_all(all_you_had_to_do_was_stay_lyrics, pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " ")
all_you_had_to_do_was_stay_lyrics[[1]] <- (tolower(all_you_had_to_do_was_stay_lyrics[[1]]))
```

```{r}
wildest_dreams_lyrics <- "He said, Let's get out of this town Drive out of this city, away from the crowds I thought, Heaven can't help me now Nothing lasts forever, but this is gonna take me down He's so tall and handsome as hell He's so bad, but he does it so well I can see the end as it begins My one condition is Say you'll remember me Standing in a nice dress, staring at the sunset, babe Red lips and rosy cheeks Say you'll see me again, even if it's just in your Wildest dreams, Wildest dreams, I said, no one has to know what we do His hands are in my hair, his clothes are in my room And his voice is a familiar sound Nothing lasts forever, but this is gettin' good now He's so tall and handsome as hell He's so bad, but he does it so well And when we've had our very last kiss My last request, it is Say you'll remember me Standing in a nice dress, staring at the sunset, babe Red lips and rosy cheeks Say you'll see me again, even if it's just in your Wildest dreams, Wildest dreams You'll see me in hindsight, tangled up with you all night Burnin' it down Someday when you leave me, I'd bet these memories Follow you around You'll see me in hindsight, tangled up with you all night Burning (burning) it (it) down (down) Someday when you leave me, I'll bet these memories Follow (follow) you (you) around (around) (Follow you around) Say you'll remember me Standing in a nice dress, staring at the sunset, babe Red lips and rosy cheeks Say you'll see me again Even if it's just pretend Say you'll remember me Standing in a nice dress, staring at the sunset, babe Red lips and rosy cheeks Say you'll see me again Even if it's just in your (pretend, just pretend) Wildest dreams,  In your wildest dreams, Even if it's just in your Wildest dreams, In your wildest dreams"
```

```{r}
wildest_dreams_lyrics <- str_replace_all(wildest_dreams_lyrics, pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " ")
wildest_dreams_lyrics[[1]] <- (tolower(wildest_dreams_lyrics[[1]]))

```


```{r, read ts5}
# Initialize an empty vector to be filled with lyrics
ts5_song_lyrics <- (rep(NA, length(ts5_names)))

# Read the data from the web source using pipe notation for brevity
for (i in 1:length(ts5_names)) {
  ts5_song_lyrics[i] <- (paste0("../data/ts5/", ts5_names[i]) %>% 
                          read_html() %>%
                          html_nodes("#lyrics") %>%
                          html_text() %>%
           # Next we'll replace new lines and dashes with spaces
                          str_replace_all(pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " "))
}

# Do some additional preprocessing

for (i in 1:length(ts5_song_lyrics)) {
  # First change everything to lowercase
  ts5_song_lyrics[[i]] <- tolower(ts5_song_lyrics[[i]])
  
  # Next remove any double quotations inside words
  ts5_song_lyrics[[i]] <- str_replace_all(ts5_song_lyrics[[i]], "\"", "")
  
  # Finally use gsub to remove the \ characters
  ts5_song_lyrics[[i]] <- (gsub("\\", "", ts5_song_lyrics[[i]], fixed = TRUE))
}

for (i in 1:length(ts5_song_lyrics)) {
  ts5_song_lyrics[[i]] <- ts5_song_lyrics[[i]][ts5_song_lyrics[[i]] != "la" & 
                                     ts5_song_lyrics[[i]] != "mmm" &
                                     ts5_song_lyrics[[i]] != ""]
}

5
```
```{r}
ts5_song_lyrics[16] <- ts5_song_lyrics[13]
ts5_song_lyrics[15] <- ts5_song_lyrics[12]
ts5_song_lyrics[14] <- ts5_song_lyrics[11]
ts5_song_lyrics[13] <- ts5_song_lyrics[10]
ts5_song_lyrics[12] <- ts5_song_lyrics[9]
ts5_song_lyrics[11] <- ts5_song_lyrics[8]
ts5_song_lyrics[10] <- ts5_song_lyrics[7]
ts5_song_lyrics[9] <- wildest_dreams_lyrics
ts5_song_lyrics[8] <- ts5_song_lyrics[6]
ts5_song_lyrics[7] <- ts5_song_lyrics[5]
ts5_song_lyrics[6] <- ts5_song_lyrics[4]
ts5_song_lyrics[5] <- all_you_had_to_do_was_stay_lyrics
ts5_song_lyrics[4] <- ts5_song_lyrics[3]
ts5_song_lyrics[3] <- ts5_song_lyrics[2]
ts5_song_lyrics[2] <- ts5_song_lyrics[1]
ts5_song_lyrics[1] <- welcome_to_ny_lyrics
```


```{r, test ts5 lyrics}
for (i in 1:length(ts5_song_lyrics)) {
  print(ts5_song_lyrics[[i]][1:5])
}
```
```{r, update ts5_names}
ts5_names <- c("Welcome to New York",
               "Blank Space",
               "Style",
               "Out of the Woods",
               "All you had to do was Stay",
               "Shake It Off",
               "I Wish You Would",
               "Bad Blood",
               "Wildest Dreams",
               "How You Get the Girl",
               "This Love",
               "I Know Places",
               "Clean",
               "Wonderland",
               "You Are in Love",
               "New Romantics")

ts5_names <- str_replace_all(ts5_names, pattern = " ", replacement = "_")

ts5_ranking <- rescale10(c(15, 13, 11, 16, 12, 9, 7, 14, 5, 8, 4, 10, 1, 3, 6, 2), 1, 16)
```


```{r ts6 names}
# Nothing Missing
ts6_names <- c("Ready For It",
               "End Game",
               "I Did Something Bad",
               "Don't Blame Me",
               "Delicate",
               "Look What You Made Me Do",
               "So It Goes",
               "Gorgeous",
               "Getaway Car",
               "King Of My Heart",
               "Dancing With Our Hands Tied",
               "Dress",
               "This Is Why We Can't Have Nice Things",
               "Call It What You Want",
               "New Year's Day")

ts6_names <- str_replace_all(ts6_names, pattern = " ", replacement = "_")

ts6_ranking <- rescale10(c(6, 1, 9, 3, 4, 15, 5, 13, 10, 12, 8, 11, 14, 2, 7), 1, 15)
```


```{r, read ts6}
# Initialize an empty vector to be filled with lyrics
ts6_song_lyrics <- (rep(NA, length(ts6_names)))

# Read the data from the web source using pipe notation for brevity
for (i in 1:length(ts6_names)) {
  ts6_song_lyrics[i] <- (paste0("../data/ts6/", ts6_names[i]) %>% 
                          read_html() %>%
                          html_nodes("#lyrics") %>%
                          html_text() %>%
           # Next we'll replace new lines and dashes with spaces
                          str_replace_all(pattern = "[\n-]", 
                                      replacement = " ") %>%
           # Next we'll replace periods, commas, !, ?, and  parentheses with ""
                          str_replace_all(pattern = "[\\.,!/?():]",
                                      replacement = "") %>%
                          str_split(pattern = " "))
}

# Do some additional preprocessing

for (i in 1:length(ts6_song_lyrics)) {
  # First change everything to lowercase
  ts6_song_lyrics[[i]] <- tolower(ts6_song_lyrics[[i]])
  
  # Next remove any double quotations inside words
  ts6_song_lyrics[[i]] <- str_replace_all(ts6_song_lyrics[[i]], "\"", "")
  
  # Finally use gsub to remove the \ characters
  ts6_song_lyrics[[i]] <- (gsub("\\", "", ts6_song_lyrics[[i]], fixed = TRUE))
}

for (i in 1:length(ts6_song_lyrics)) {
  ts6_song_lyrics[[i]] <- ts6_song_lyrics[[i]][ts6_song_lyrics[[i]] != "la" & 
                                     ts6_song_lyrics[[i]] != "mmm" &
                                     ts6_song_lyrics[[i]] != ""]
}

6
```


```{r, test ts6 lyrics}
for (i in 1:length(ts6_song_lyrics)) {
  print(ts6_song_lyrics[[i]][1:5])
}
```

```{r, combine all albums into one list}
all_ts_song_names <- c(ts1_names,
                       ts2_names,
                       fp_names,
                       ts3_names,
                       ts4_names,
                       ts5_names,
                       ts6_names)

all_ts_song_names <- str_replace_all(all_ts_song_names, pattern = "_", replacement = " ")

all_ts_song_lyrics <- c(ts1_song_lyrics,
                        ts2_song_lyrics,
                        fp_song_lyrics,
                        ts3_song_lyrics,
                        ts4_song_lyrics,
                        ts5_song_lyrics,
                        ts6_song_lyrics)
names(all_ts_song_lyrics) <- all_ts_song_names
```

```{r, remove the word i from all lyrics}
for (i in 1:length(all_ts_song_lyrics)) {
  all_ts_song_lyrics[[i]] <- all_ts_song_lyrics[[i]][all_ts_song_lyrics[[i]] != "i"]
}
```

```{r, make a data frame with title and words}
# Initialize vectors of the correct length
total_words_by_ts_song <- rep(0, length(all_ts_song_lyrics))
unique_words_by_ts_song <- rep(0, length(all_ts_song_lyrics))

# Use a for loop to add the accurate length one song at a time
for (i in 1:length(total_words_by_ts_song)) {
  total_words_by_ts_song[i] <- length(all_ts_song_lyrics[[i]])
}

# Use a for loop to add the number of unique words per song
for (i in 1:length(unique_words_by_ts_song)) {
  unique_words_by_ts_song[i] <- length(unique(all_ts_song_lyrics[[i]]))
}
# Make a dataframe with one row per song: 
ts_song_frame <- data.frame("Title" = all_ts_song_names,
                         "Total_Words" = total_words_by_ts_song)

ts_song_frame$Unique_Words <- unique_words_by_ts_song
```

```{r, update data frame}
# Divide the unique words by the total words for the fraction that are unique
ts_frac_unique <- unique_words_by_ts_song/total_words_by_ts_song

# Add the appropriate column
ts_song_frame$Fraction_Unique <- ts_frac_unique

# Add a column specifying years since 2006
years_since_2006 <- c(rep(0, 14), rep(2, 13), rep(3, 5), rep(4, 14), rep(6, 16), rep(8, 16), rep(11, 15))
ts_song_frame$Years_Since_2006 <- years_since_2006

# Add a column for album
album <- c(rep("Taylor Swift", 14),
           rep("Fearless", 13),
           rep("Fearless Platinum", 5),
           rep("Speak Now", 14),
           rep("Red", 16),
           rep("1989", 16),
           rep("Reputation", 15))

ts_song_frame$Album <- album
head(ts_song_frame)
```

```{r, create a plot}
ts_song_frame$Years_Since_2006 <- as.numeric(ts_song_frame$Years_Since_2006)
ts_song_plot <- (ggplot(data = ts_song_frame,
                        aes(x = Years_Since_2006,
                            y = Fraction_Unique,
                            color = Album)) + 
                   geom_point(size = 2) +
                  # geom_smooth(method = loess, aes(x = Years_Since_2006, y = Fraction_Unique)) +
                   #geom_label(aes(label = Title),
                              #alpha = .75,
                             # nudge_x = .25,
                             # nudge_y = .01,
                             # size = 2.5) +
        # This next line ensures the labels aren't cut off
                   xlim(c(-1, 13)) +
                   labs(title = "Song Lyric Uniqueness Over Time",
                         x = "Years Since Taylor's First Album",
                         y = "Fraction of Words that are Unique (by Song)") +
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold"))) 

ts_song_plot
```

```{r}
ts_song_plot_faceted <- (ggplot(data = ts_song_frame,
                        aes(x = 1,
                            y = Fraction_Unique)) +#,
                            #color = Album)) + 
                   geom_point(size = 2) +
                   geom_label(aes(label = Title),
                            alpha = .75,
                              nudge_x = 0,
                              nudge_y = 0,
                              size = 2.5) +
        # This next line ensures the labels aren't cut off
                  # xlim(c(-1, 13)) +
                   scale_x_discrete(limits = c(0,1)) +
                   labs(title = "Song Word Uniqueness Across Albums",
                         x = "Album",
                         y = "Fraction of Lyrics that are Unique") +
        # Facet by album
                  facet_grid(~Album, scales = "free_y") +
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold")))
ts_song_plot_faceted

```

```{r, eval=FALSE}
ggsave("../output/faceted_uniqueness_labels.png",
       plot = ts_song_plot_faceted,
       height = 7,
       width = 10,
       units = "in")
```

```{r}
global_ave <- mean(ts_song_frame$Fraction_Unique)
global_ave
```


```{r, display ts1 on its own scale}
ts1_album <- filter(ts_song_frame, Album == "Taylor Swift")

ts1_plot <- (ggplot(data = ts1_album,
                        aes(x = Years_Since_2006,
                            y = Fraction_Unique)) + #,
                            #color = "Yellow")) + 
                   geom_point(size = 3, color = "light blue") +
                   geom_label(aes(label = Title),
                              alpha = .5,
                             # nudge_x = .25,
                              #nudge_y = .01,
                              size = 2.5) +
        # This next line ensures the labels aren't cut off
                   xlim(c(-.5,0.5)) +
                   labs(title = "Uniqueness in 'Taylor Swift'",
                         x = "Taylor's First Album",
                         y = "Fraction of Lyrics that are Unique") +
                   geom_hline(yintercept = mean(ts1_album$Fraction_Unique)) +
                   annotate("text", x = .25, y = .393,
                           label = "Average for 'Taylor Swift'") +
                   geom_hline(yintercept = global_ave) +
                   annotate("text", x = .25, y = .356,
                           label = "Overall Average") +
          
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold")))
ts1_plot
```

```{r, display ts2 on its own scale}
ts2_album <- filter(ts_song_frame, Album == "Fearless")

ts2_plot <- (ggplot(data = ts2_album,
                        aes(x = Years_Since_2006,
                            y = Fraction_Unique)) + #,
                            #color = "Yellow")) + 
                   geom_point(size = 3, color = "yellow") +
                   geom_label(aes(label = Title),
                              alpha = .5,
                             # nudge_x = .25,
                             # nudge_y = .01,
                              size = 2.5) +
        # This next line ensures the labels aren't cut off
                   xlim(c(1.5,2.5)) +
                   labs(title = "Uniqueness in 'Fearless'",
                         x = "Taylor's Second Album",
                         y = "Fraction of Lyrics that are Unique") +
                   geom_hline(yintercept = mean(ts2_album$Fraction_Unique)) +
                   annotate("text", x = 2.25, y = .408,
                           label = "Average for Fearless") +
                   geom_hline(yintercept = global_ave) +
                   annotate("text", x = 2.25, y = .356,
                           label = "Overall Average") +
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold")))
ts2_plot
```
```{r, display fearless platinum on its own scale}
fp_album <- filter(ts_song_frame, Album == "Fearless Platinum")

fp_plot <- (ggplot(data = fp_album,
                        aes(x = Years_Since_2006,
                            y = Fraction_Unique)) + #,
                            #color = "Yellow")) + 
                   geom_point(size = 3, color = "grey") +
                   geom_label(aes(label = Title),
                              alpha = .5,
                             # nudge_x = .25,
                             # nudge_y = .01,
                              size = 2.5) +
        # This next line ensures the labels aren't cut off
                   xlim(c(2.5,3.5)) +
                   labs(title = "Uniqueness in 'Fearless Platinum'",
                         x = "Extra Songs from Fearless",
                         y = "Fraction of Lyrics that are Unique") +
                   geom_hline(yintercept = mean(fp_album$Fraction_Unique)) +
                   annotate("text", x = 3.25, y = .3657,
                           label = "Average for Fearless Platinum") +
                   geom_hline(yintercept = global_ave) +
                   annotate("text", x = 3.25, y = .3555,
                           label = "Overall Average") +
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold")))
fp_plot

```


```{r, display ts3 on its own scale}
ts3_album <- filter(ts_song_frame, Album == "Speak Now")

ts3_plot <- (ggplot(data = ts3_album,
                        aes(x = Years_Since_2006,
                            y = Fraction_Unique)) + #,
                            #color = "Yellow")) + 
                   geom_point(size = 3, color = "purple") +
                   geom_label(aes(label = Title),
                              alpha = .75,
                             # nudge_x = .25,
                             # nudge_y = .01,
                              size = 2.5) +
        # This next line ensures the labels aren't cut off
                   xlim(c(3.5,4.5)) +
                   labs(title = "Uniqueness in 'Speak Now'",
                         x = "Taylor's Third Album",
                         y = "Fraction of Lyrics that are Unique") +
                   geom_hline(yintercept = mean(ts3_album$Fraction_Unique)) +
                   annotate("text", x = 4.25, y = .382,
                           label = "Average for Speak Now") +
                  geom_hline(yintercept = global_ave) +
                   annotate("text", x = 4.25, y = .354,
                           label = "Overall Average") +
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold")))
ts3_plot
```


```{r, display ts4 on its own scale}
ts4_album <- filter(ts_song_frame, Album == "Red")

ts4_plot <- (ggplot(data = ts4_album,
                        aes(x = Years_Since_2006,
                            y = Fraction_Unique)) + #,
                            #color = "Yellow")) + 
                   geom_point(size = 3, color = "red") +
                   geom_label(aes(label = Title),
                              alpha = .5,
                             # nudge_x = .25,
                              nudge_y = .01,
                              size = 2.5) +
        # This next line ensures the labels aren't cut off
                   xlim(c(5.5,6.5)) +
                   labs(title = "Uniqueness in 'Red'",
                         x = "Taylor's Fourth Album",
                         y = "Fraction of Lyrics that are Unique") +
                  geom_hline(yintercept = mean(ts4_album$Fraction_Unique)) +
                  annotate("text", x = 6.25, y = .376,
                           label = "Average for Red") +
                  geom_hline(yintercept = global_ave) +
                  annotate("text", x = 6.25, y = .356,
                           label = "Overall Average") +
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold")))
ts4_plot
```

```{r, display ts5 on its own scale}
ts5_album <- filter(ts_song_frame, Album == "1989")

ts5_plot <- (ggplot(data = ts5_album,
                        aes(x = Years_Since_2006,
                            y = Fraction_Unique)) + #,
                            #color = "Yellow")) + 
                   geom_point(size = 3, color = "green") +
                   geom_label(aes(label = Title),
                              alpha = .5,
                             # nudge_x = .25,
                              nudge_y = .01,
                              size = 2.5) +
        # This next line ensures the labels aren't cut off
                   xlim(c(7.5, 8.5)) +
                   labs(title = "Uniqueness in '1989'",
                         x = "Taylor's Fifth Album",
                         y = "Fraction of Lyrics that are Unique") +
                  geom_hline(yintercept = mean(ts5_album$Fraction_Unique)) +
                  annotate("text", x = 8.2, y = .295,
                           label = "Average for 1989") + 
                  geom_hline(yintercept = global_ave) +
                  annotate("text", x = 8.25, y = .358,
                           label = "Overall Average") +
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold")))
ts5_plot
```

```{r, display ts6 on its own scale}
ts6_album <- filter(ts_song_frame, Album == "Reputation")

ts6_plot <- (ggplot(data = ts6_album,
                        aes(x = Years_Since_2006,
                            y = Fraction_Unique)) + #,
                            #color = "Yellow")) + 
                   geom_point(size = 3, color = "black") +
                   geom_label(aes(label = Title),
                              alpha = .5,
                             # nudge_x = .25,
                              nudge_y = .005,
                              size = 2.5) +
        # This next line ensures the labels aren't cut off
                   xlim(c(10.5,11.5)) +
                  geom_hline(yintercept = mean(ts6_album$Fraction_Unique)) +
                  annotate("text", x = 11.3, y = .2905, label = "Average for Reputation") +
                  geom_hline(yintercept = global_ave) +
                  annotate("text", x = 11.3, y = .3535,
                           label = "Overall Average") +
                   labs(title = "Uniqueness in 'Reputation'",
                         x = "Taylor's Sixth Album",
                         y = "Fraction of Lyrics that are Unique") +
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold")))
ts6_plot
```


```{r}
to_extract_aves <- summarize(group_by(ts_song_frame, Album), ave = mean(Fraction_Unique))
to_extract_aves
ave_frac_unique <- c(to_extract_aves$ave[7], 
                     to_extract_aves$ave[2],
                     to_extract_aves$ave[3],
                     to_extract_aves$ave[6], 
                     to_extract_aves$ave[4],
                     to_extract_aves$ave[1], 
                     to_extract_aves$ave[5])
ave_frac_unique
ave_by_album <- data.frame("Album" = c("Taylor Swift",
                                       "Fearless",
                                       "Fearless Platinum",
                                       "Speak Now",
                                       "Red",
                                       "1989",
                                       "Reputation"),
                           "Ave_Unique" = ave_frac_unique,
                           "Album_Number" = c(1,2,2.5,3,4,5,6))
ave_by_album
```


```{r}
ave_by_album_plot <- (ggplot(data = ave_by_album,
                        aes(x = Album_Number,
                            y = Ave_Unique)) + 
                   geom_point(size = 5, aes(color = Album)) +
                   #geom_smooth(method = lm) +
                   geom_label(aes(label = Album, color = Album),
                            alpha = 1,
                             # nudge_x = .25,
                              nudge_y = .01,
                              size = 2.5) +
        # This next line ensures the labels aren't cut off
                  #scale_x_continuous(labels = c(1,2,3,4,5,6)) +
                  ylim(c(.25, .45)) +
                   labs(title = "Average Song Word Uniqueness Across Albums",
                         x = "Album Number",
                         y = "Fraction of Lyrics that are Unique") +
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold",
                          legend.position = "none"))) 

ave_by_album_plot
```


```{r, examine uniqueness against song length}
song_len_vs_unique_cor <- cor(ts_song_frame$Total_Words, ts_song_frame$Fraction_Unique)
ts_len_vs_unique <- (ggplot(data = ts_song_frame,
                        aes(x = Total_Words,
                            y = Fraction_Unique)) + 
                   geom_point(size = 4, aes(color  = Album)) +
                   #geom_label(aes(label = Title, color = Album),
                             # alpha = 1,
                             # nudge_x = .25,
                             # nudge_y = .01,
                             # size = 2.5) +
                   labs(title = "Song Word Uniqueness Against Length",
                         x = "Total Words",
                         y = "Fraction of Lyrics that are Unique") +
                    # ylim(c(0,1)) +
        # This puts in text describing the R^2 value for these variables
                       annotate("text", x=575, y=.45, size = 6,
                                label= "italic(R) == -.602", parse = TRUE) +
        # This is totally optional and just to make the plot look better
                    theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold")) +
        # This adds in the linear regression line
                          geom_smooth(method = lm))
ts_len_vs_unique

```

You can see that as songs get longer, there is a smaller fraction of their words which are unique. Also, you can see that songs on the same album tend to be clustered together on this graph, showing that within each album songs tend to be of a similar length and uniqueness as compared to songs on other albums. 

```{r, distribution of word lengths}
# Before I took out the word 'I.' Now I'll put it back. 

all_ts_song_lyrics_with_i <- c(ts1_song_lyrics,
                        ts2_song_lyrics,
                        fp_song_lyrics,
                        ts3_song_lyrics,
                        ts4_song_lyrics,
                        ts5_song_lyrics,
                        ts6_song_lyrics)

names(all_ts_song_lyrics_with_i) <- all_ts_song_names

word_lengths <- rep(0, 20)
for (song in all_ts_song_lyrics_with_i) {
  for (word_pos in 1:length(song)) {
    current_length <- nchar(song[word_pos])
    word_lengths[current_length] <- word_lengths[current_length] + 1
  }
}
word_lengths
#for (song in all_ts_song_lyrics_with_i) {
  #for (word_pos in 1:length(song)) {
    #current_length <- nchar(song[word_pos])
    #if (song[word_pos] == "i") {
      #print(song[word_pos])
    #}
  #}
#}


## The longest word in any Taylor Swift song is "miscommunications" in The Story of Us.
```

```{r}
word_lengths <- word_lengths[1:17]
word_lengths
word_length_frame <- data.frame("length" = 1:17,
                                "count" = word_lengths)
word_length_dist <- (ggplot(data = word_length_frame, aes(x = length, y = count)) + 
                       geom_bar(stat = "identity", fill = "blue", alpha = .75) +
                       geom_text(label = word_lengths,
                                 nudge_y = 200) +
                       scale_x_continuous(breaks = 1:17) +
                       labs(title = "Distribution of Word Lengths in Taylor Swift Songs",
                            x = "Number of Letters",
                            y = "Number of Words") +
                       theme(plot.title = element_text(color = "black",
                                                    size = 14,
                                                    face = "bold.italic"),
                          axis.title.x = element_text(size = 12,
                                                  face = "bold"),
                          axis.title.y = element_text(size = 12,
                                                      face = "bold")))
                            
word_length_dist
?geom_text
```

Taylor's favorite number is 13. Let's see the words she's used that are 13 letters long. 

```{r}
for (song in all_ts_song_lyrics_with_i) {
  for (word_pos in 1:length(song)) {
    current_length <- nchar(song[word_pos])
    if (current_length == 13) {
      print(song[word_pos])
    }
  }
}

```

She's used the words "condescending," "interruptions," and "heartbreakers" (three times).

Let's see if there's a correlation between song word uniqueness and average number of letters per song. 

```{r}
get_average_length <- function(song) {
  total_characters <- 0
  num_words <- length(song)
  for (word in song) {
    total_characters <- total_characters + nchar(word)
  }
  ave_characters <- total_characters / num_words
  return(ave_characters)
}
get_average_length(all_ts_song_lyrics[[1]])
ave_length_by_song <- rep(0,length(all_ts_song_lyrics))
for (i in 1:length(all_ts_song_lyrics)) {
  ave_length_by_song[i] <- get_average_length(all_ts_song_lyrics[[i]])
}
ts_song_frame$Ave_Word_Length <- ave_length_by_song
```

```{r}
word_len_vs_unique_cor <- cor(ts_song_frame$Ave_Word_Length, ts_song_frame$Fraction_Unique)

word_len_vs_uniqueness <- (ggplot(data = ts_song_frame, aes(x = Ave_Word_Length, y = Fraction_Unique)) +
                             geom_point(size = 3,
                                        aes(color = Album)) +
                             geom_smooth(method = "lm") +
                             annotate("text", x=4.3, y=.49, size = 6,
                                label= "italic(R) == .475", parse = TRUE))
word_len_vs_uniqueness
```

There is a positive association between the average word length and the fraction of lyrics that are unique. This is probably because it's more common to repeat short words than long words (for example "Are we out of the woods yet?" has an average word length of only 3). 

```{r}
#++++++++++++++++++++++++++++++++++
# rquery.wordcloud() : Word cloud generator
# - http://www.sthda.com
# I DID NOT WRITE THIS
# URL SUPPORT WAS NOT IMPORTED SINCE I'M NOT USING THAT
#+++++++++++++++++++++++++++++++++++
# x : character string (plain text, web url, txt file path)
# type : specify whether x is a plain text, a web page url or a file path
# lang : the language of the text
# excludeWords : a vector of words to exclude from the text
# textStemming : reduces words to their root form
# colorPalette : the name of color palette taken from RColorBrewer package, 
  # or a color name, or a color code
# min.freq : words with frequency below min.freq will not be plotted
# max.words : Maximum number of words to be plotted. least frequent terms dropped
# value returned by the function : a list(tdm, freqTable)
rquery.wordcloud <- function(x, type=c("text", "url", "file"), 
                          lang="english", excludeWords=NULL, 
                          textStemming=FALSE,  colorPalette="Dark2",
                          min.freq=3, max.words=200)
{ 
  
  if(type[1]=="file") text <- readLines(x)
  else if(type[1]=="url") text <- html_to_text(x)
  else if(type[1]=="text") text <- x
  
  # Load the text as a corpus
  docs <- Corpus(VectorSource(text))
  # Convert the text to lower case
  docs <- tm_map(docs, content_transformer(tolower))
  # Remove numbers
  docs <- tm_map(docs, removeNumbers)
  # Remove stopwords for the language 
  docs <- tm_map(docs, removeWords, stopwords(lang))
  # Remove punctuations
  docs <- tm_map(docs, removePunctuation)
  # Eliminate extra white spaces
  docs <- tm_map(docs, stripWhitespace)
  # Remove your own stopwords
  if(!is.null(excludeWords)) 
  docs <- tm_map(docs, removeWords, excludeWords) 
  # Text stemming
  if(textStemming) docs <- tm_map(docs, stemDocument)
  # Create term-document matrix
  tdm <- TermDocumentMatrix(docs)
  m <- as.matrix(tdm)
  v <- sort(rowSums(m),decreasing=TRUE)
  d <- data.frame(word = names(v),freq=v)
  # check the color palette name 
  if(!colorPalette %in% rownames(brewer.pal.info)) colors = colorPalette
  else colors = brewer.pal(8, colorPalette) 
  # Plot the word cloud
  set.seed(123)
  wordcloud(d$word,d$freq, min.freq=min.freq, max.words=max.words,
            random.order=FALSE, rot.per=0.35, 
            use.r.layout=FALSE, colors=colors)
  
  invisible(list(tdm=tdm, freqTable = d))
}

```


```{r}
all_word_list <- rep(NA, 20000)
i <- 1
for (song in all_ts_song_lyrics_with_i) {
  for (word_pos in 1:length(song)) {
    all_word_list[i] <- song[word_pos]
    i <- i + 1
  }
}
length(all_word_list)
all_long_words <- all_word_list[nchar(all_word_list) >= 4]
wordcloud_gen_object <- rquery.wordcloud(all_long_words, type = "text", 
        lang= "english", excludeWords = NULL, 
        textStemming = FALSE,  colorPalette="BuPu",
        max.words=100)

```



```{r}
text_matrix <- wordcloud_gen_object$tdm
frequency_table_ts <- wordcloud_gen_object$freqTable
# These are the top 10 most used words:
head(frequency_table_ts, 10)
```

Here are the words Taylor has used exactly 13 times: 
```{r}
filter(frequency_table_ts, freq == 13)
```

```{r}
all_ts_song_rankings <- c(ts1_ranking,
                          ts2_ranking,
                          fp_ranking,
                          ts3_ranking,
                          ts4_ranking,
                          ts5_ranking,
                          ts6_ranking)

ts_song_frame$Ranking <- all_ts_song_rankings
```

```{r}
# Recall that lower rankings are better
cor(ts_song_frame$Ranking, ts_song_frame$Fraction_Unique)
rank_vs_uniq <- (ggplot(data = ts_song_frame, aes(x = Ranking,
                                                  y = Fraction_Unique,
                                                  color = Album)) +
                   geom_point() +
                   geom_smooth(method = "lm", se = FALSE))
                
rank_vs_uniq
```


```{r}

```

